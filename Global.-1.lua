-- the Utils obj it's just a way for me to seperate the utility functions
-- in this API we'll need the GUID if we want to use its functions
UTILS = 'db716c'

TABLE_HEIGHT = 1.41

-- ! OBJECTS PLACEMENT
PLAYERS = {
    white = {
        origin = {},
        objects = {
            non_buyable_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            brown_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            grey_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            commerce_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            blue_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            war_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            naval_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            compass_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            tablet_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            gear_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            green_island_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            purple_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            black_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },
        }
    },

    purple = {
        origin = {},
        objects = {
            non_buyable_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            brown_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            grey_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            commerce_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            blue_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            war_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            naval_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            compass_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            tablet_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            gear_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            green_island_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            purple_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            black_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },
        }
    },

    red = {
        origin = {},
        objects = {
            non_buyable_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            brown_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            grey_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            commerce_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            blue_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            war_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            naval_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            compass_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            tablet_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            gear_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            green_island_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            purple_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            black_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },
        }
    },

    yellow = {
        origin = {},
        objects = {
            non_buyable_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            brown_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            grey_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            commerce_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            blue_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            war_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            naval_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            compass_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            tablet_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            gear_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            green_island_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            purple_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            black_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },
        }
    },

    green = {
        origin = {},
        objects = {
            non_buyable_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            brown_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            grey_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            commerce_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            blue_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            war_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            naval_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            compass_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            tablet_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            gear_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            green_island_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            purple_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            black_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },
        }
    },

    orange = {
        origin = {},
        objects = {
            non_buyable_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            brown_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            grey_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            commerce_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            blue_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            war_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            naval_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            compass_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            tablet_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            gear_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            green_island_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            purple_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            black_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },
        }
    },

    blue = {
        origin = {},
        objects = {
            non_buyable_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            brown_res_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            grey_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            commerce_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            blue_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            war_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            naval_conflict_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            compass_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            tablet_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            gear_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            green_island_stack = {
                guid_zone = '',
                origin =nil,

                cards = {}
            },

            purple_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            },

            black_stack = {
                guid_zone = '',
                origin = nil,

                cards = {}
            }
        }
    }
}

OBJECTS_OFFSETS = {
    ['stacks'] = {
        ['non_buyable_res_stack'] = -16.2,
        ['brown_res_stack'] = -13.50,
        ['grey_stack'] = -10.80,
        ['commerce_stack'] = -8.10,
        ['blue_stack'] = -5.40,
        ['war_conflict_stack'] = -2.70,
        ['naval_conflict_stack'] = 0,
        ['compass_stack'] = 2.70,
        ['tablet_stack'] = 5.40,
        ['gear_stack'] = 8.10,
        ['green_island_stack'] = 10.80,
        ['purple_stack'] = 13.50,
        ['black_stack'] = 16.2,

        ['z'] = 41
    },

    ['wonder'] = 14,
    
    ['coins'] = {
        x = 5,
        z = 17.5,
        padding = -0.80
    }
}

-- ! CARDS AND TOKENS GUID

-- base game
BASE_DECK_GUID = {
    ['age1'] = {'501ae8', '9b51a7', '6123d4', 'bf52e6', 'a5a6ee'},
    ['age2'] = {'8e40b9', '1a8f31', 'e96ff5', '912d26', '453cee'},
    ['age3'] = {'88f04b', '92c03a', 'b0035e', 'c2a4ea', '864847'}
}

GUILD_DECK_GUID = 'a5b1c7'

WONDERS_BAGS = {
    ['base'] = '56d45b',
    ['leaders'] = '053343',
    ['cities'] = 'a49969',
    ['armada'] = 'e1435d',
    ['edifice'] = 'd9d9c0'
}

COINS_BAGS = {
    '3f95a5',
    '3cad45',
    '9e60c9'
}

-- ! FUNCTIONS 
-- if you are looking for something it's probably in the onLoad() function 
    
function onSave()
end

-- ! ONLOAD()
-- one important feature of this mod is the auto placement of cards
-- every single column in a player's board is made for specific kind of cards (not colors)
-- so to make things easier we calculate every origin(x, y, z) for each stack
function onLoad(saved_data)

    -- instaed of editing every value of PLAYERS we'll just use a temp table
    local new_stack = Global.getTable('PLAYERS')

    for _, color in pairs(getSeatedPlayers()) do

        -- for every player we calculate these origins based on its hand transform (position, rotation etc. etc.)
        local origin = Player[string.lower(color)].getHandTransform(1)

        -- a table of offsets for each kind of cards
        local stack_offsets = Global.getTable('OBJECTS_OFFSETS')['stacks']

        -- for every kind of stack we then calculate the origin using our offsets
        for stack_name, _ in pairs(new_stack[string.lower(color)]['objects']) do

            -- the origin we are going to calculate
            local stack_origin = Vector(0, 0, 0)
            stack_origin[1] = origin.position[1] + origin.forward[1] * stack_offsets['z'] + origin.right[1] * stack_offsets[stack_name]
            stack_origin[2] = TABLE_HEIGHT
            stack_origin[3] = origin.position[3] + origin.forward[3] * stack_offsets['z'] + origin.right[3] * stack_offsets[stack_name]

            -- in the end we update the origin in our temp table
            new_stack[string.lower(color)]['objects'][stack_name]['origin'] = stack_origin
        end

    end

    -- lastly we commit the changes to the original table
    Global.setTable('PLAYERS', new_stack)
end